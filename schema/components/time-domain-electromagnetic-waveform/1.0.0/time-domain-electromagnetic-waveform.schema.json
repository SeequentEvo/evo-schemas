{
  "$id": "/components/time-domain-electromagnetic-waveform/1.0.0/time-domain-electromagnetic-waveform.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Time domain electromagnetic waveform.",
  "type": "object",
  "properties": {
    "cycle_duration": {
      "description": "Waveform cycle duration (msec).",
      "type": "number",
      "minimum": 0
    },
    "sampling_time": {
      "description": "Sampling time (relative to starting time = 0) (msec), precision: 1/1000 of a second",
      "type": "number",
      "minimum": 0.0
    },
    "type": {
      "description": "The waveform type.",
      "type": "string",
      "enum": [
        "SQUARE",
        "BIPOLARTRAPEZOID"
      ]
    },
    "waveforms": {
      "description": "Description of waveforms",
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Waveform ID number.",
            "minimum": 0
          },      
          "waveform": {
            "description": "First column is the time (s), second column is the amplitude (current) (Amp).",
            "$ref": "/elements/float-array-2/1.0.1/float-array-2.schema.json"
          }
        },
        "required": [
          "id",
          "waveform"
        ]
      }
    },
    "system_responses": {
      "description": "Description of system responses, only required if using SkyTEM systems.",
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "number_repetitions": {
            "type": "integer",
            "description": "Number of repetitions",
            "minimum": 0
          },          
          "start_timestamp": {
            "description": "Beginning of time where system response is applied.",
            "type": "string",
            "format": "date-time"
          },
          "end_timestamp": {
            "description": "End of time where system response is applied.",
            "type": "string",
            "format": "date-time"
          },
          "response": {
            "description": "System response times",
            "type": "object",
            "properties": {
              "data": {
                "description": "The binary data for the system response. Columns: time, response, sign pattern.",
                "$ref": "/elements/binary-blob/1.0.1/binary-blob.schema.json"
              },
              "length": {
                "type": "integer",
                "description": "length of array",
                "minimum": 0,
                "default": 0
              },
              "width": {
                "description": "number of columns",
                "const": 3
              },
              "data_type": {
                "type": "string",
                "description": "Data type for the columns. 1st column is of type float64, 2nd is float64 and 3rd is bool.",
                "const": "float64/float64/bool"
              }
            },
            "required": [
              "data",
              "length",
              "width",
              "data_type"
            ]            
          }          
        },
        "required": [
          "number_repetitions",
          "start_timestamp",
          "end_timestamp",
          "response"
        ]
      }
    }
  },
  "required": [
    "waveforms"
  ]
}
